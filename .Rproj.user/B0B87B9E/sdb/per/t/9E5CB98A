{
    "contents" : "#This code explores the Chicago Institute for Housing dataset and will\n#produce a visualization that provides insight on home/rent affordability\n#by neighborhood or Census Tract\n\n#Initialization borrowed from Gene Leynes @geneorama\n#===================================================\n\n## Remove all objects; perform garbage collection\nrm(list=ls())\ngc(reset=TRUE)\n\n## Check for dependencies\nif(!\"geneorama\" %in% rownames(installed.packages())){\n  if(!\"devtools\" %in% rownames(installed.packages())){\n    install.packages('devtools')\n  }\n  devtools::install_github('geneorama/geneorama')\n}\n\n## Load libraries\ngeneorama::detach_nonstandard_packages()\n# geneorama::loadinstall_libraries(c(\"geneorama\", \"knitr\", \"caret\", \"gbm\", \n#     \t\t\t\t\t\t   \"glmnet\", \"ROCR\", \"pROC\", \"plyr\", \"class\", \n# \t\t\t\t\t\t\t\t   \"hmeasure\", \"randomForest\", \n# \t\t\t\t\t\t\t\t   \"AppliedPredictiveModeling\", \"data.table\", \n# \t\t\t\t\t\t\t\t   \"doParallel\", \"e1071\", \"rpart\"))\ngeneorama::loadinstall_libraries(c(\"geneorama\", \"knitr\", \"data.table\", \"ggplot2\"))\n#===================================================\n\n\n#Load in & prep data\n#===================================================\n\nchi <- read.csv(file = \"chicago.csv\", header = T, stringsAsFactors = F)\nchi <- as.data.table(chi)\nstr(chi)\n\n#variables of interest appear to be first 8 columns and last 2\nchi <- chi[,c(1:8,56:57), with = F]\nstr(chi)\n\n#gross rent and home value should be integers. change \"-\" to 0\nchi[Median.Gross.Rent == \"-\", Median.Gross.Rent := \"0\"]\nchi[Median.Home.Value == \"-\", Median.Home.Value := \"0\"]\n#convert these variables to numeric\nchi[,Median.Gross.Rent := as.numeric(Median.Gross.Rent)]\nchi[,Median.Home.Value := as.numeric(Median.Home.Value)]\nstr(chi)\n\n#let's look at some of the neighborhoods\nunique(chi$City..Suburb)\nNROW(unique(chi$Community.Area))\n#there are 77 neighborhoods. how are the Census Tracts distributed across\n#these neighborhoods?\np.hoods <- ggplot(data = chi)\np.hoods + geom_bar(aes(x = Community.Area, y = ..count..))\n\n#bar chart not a good way to look at them. too many neighborhoods. way too\n#many tracts.\n\n\n#if i want to look at rents. do I have any outliers?\np.rents <- ggplot(data = chi)\np.rents +\n  geom_histogram(aes(x = Median.Gross.Rent)) +\n  scale_x_continuous(name = \"Median Gross Rent\") +\n  ggtitle(\"Distribution of Median Gross Rent per Chicago Census Tracts\")\n\n\n#Lets start looking at maps instead\n#===================================================\n\n#leaflet\n#===================================================\n#load req'd packages\ngeneorama::loadinstall_libraries(c(\"leaflet\", \"magrittr\",\n                                   \"rgdal\", \"RColorBrewer\"))\n\n\n#load in Chicago community areas & tracts shape file\nhoods <- readOGR(dsn = \".\",layer = \"chicomm\", verbose = F)\ntracts <- readOGR(dsn = \".\", layer = \"cb_2014_17_tract_500k\", verbose = F)\n#format community area strings to map in data later\nhoods$DISTITLE <- as.character(hoods$DISTITLE)\nhoods$DISTITLE <- toupper(hoods$DISTITLE)\n\n#check to see if the community names are the same\nsort(hoods$DISTITLE) == sort(unique(chi$Community.Area))\n\n#this will subset the tracts to only include the tracts in the chi dataset\ntracts <- subset(tracts, tracts$GEOID %in% chi$TRACTFIPS10)\n\n#this is how to append data to a spdf. appending attributes from chi dataset\n#sp@data = data.frame(sp@data, df[match(sp@data$col, df$col),])\ntracts@data = data.frame(tracts@data, chi[match(tracts@data$GEOID, chi$TRACTFIPS10),])\n\n\n#create a color palette\npal <- colorNumeric(palette = brewer.pal(7,\"PuBu\"),\n                    domain = tracts@data$Median.Gross.Rent)\n\n#concatenate strings for a more descriptive popup\ntract_popup <- paste0(\"<p>Neighborhood: \",\n                      tracts@data$Community.Area,\n                      \"</p>\",\n                      \"Median Gross Rent: $\",\n                      as.character(tracts@data$Median.Gross.Rent))\n\n\n#test plot\np.test <- leaflet() %>%\n  addTiles() %>%\n  addPolygons(data = hoods,\n              smoothFactor = 0.2,\n              stroke = T,\n              fillOpacity = 0,\n              color = \"blue\") %>%\n  addPolygons(data = tracts,\n              smoothFactor = 0.2,\n              stroke = F,\n              fillOpacity = 0.75,\n              color = ~pal(Median.Gross.Rent),\n              popup = tract_popup)\n#   addCircleMarkers(data = chi,\n#                    lng = ~LON,\n#                    lat = ~LAT,\n#                    popup = ~as.character(Median.Household.Income))\n  \np.test\n\n#how to concatenate strings for a more descriptive popup\n# state_popup <- paste0(\"<strong>Estado: </strong>\", \n#                       mexico$name, \n#                       \"<br><strong>PIB per c?pita, miles de pesos, 2008: </strong>\", \n#                       mexico$gdp08)\n\n\n#===================================================",
    "created" : 1446261463614.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2089403646",
    "id" : "9E5CB98A",
    "lastKnownWriteTime" : 1446487155,
    "path" : "D:/CSC465/CSC465/ChiAfford.R",
    "project_path" : "ChiAfford.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}